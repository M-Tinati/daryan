{% extends 'base.html' %}
{% load i18n static humanize widget_tweaks %}

{% block title %}{% trans "صفحه اصلی | کارخانه لوله پلی اتیلن" %}{% endblock %}

{% block content %}
<body class="bg-white">
<!-- فونت Vazirmatn به‌صورت سراسری در استایل‌ها اعمال شده -->

<!-- ===== Hero Section ===== -->
<section class="relative overflow-hidden h-96 sm:h-[500px] md:h-[600px] lg:h-[700px]">
  <div class="absolute inset-0 bg-gradient-to-b from-blue-100/50 via-white to-blue-100/50 z-10"></div>
  <img
    src="{% static '/images/shutterstock_1785976883.jpg' %}"
    alt="polyethylene factory"
    class="w-full h-full object-cover transition-transform duration-1000 ease-in-out hover:scale-105 "
    id="heroImage"
  >
  <div class="absolute inset-0 flex flex-col items-center justify-center text-center text-gray-900 px-4 sm:px-6 lg:px-8 z-20">
    <h1
      class="text-3xl sm:text-4xl md:text-5xl lg:text-6xl font-extrabold mb-5 tracking-tight opacity-0 translate-y-10 transition-all duration-800 ease-in-out delay-200 hero-animate font-vazir"
      id="heroTitle"
    >
      {% trans "لوله‌های پلی‌اتیلن با کیفیت جهانی" %}
    </h1>
    <p
      class="mb-8 text-base sm:text-lg md:text-xl lg:text-2xl max-w-3xl opacity-0 translate-y-10 transition-all duration-800 ease-in-out delay-400 hero-animate font-vazir text-gray-700"
      id="heroText"
    >
      {% trans "محصولات با دوام، قیمت رقابتی و تحویل سریع برای پروژه‌های شما" %}
    </p>
    <a
      href="{% url 'shop:product_list' %}"
      class="relative bg-gradient-to-r from-blue-500 to-cyan-500 hover:from-blue-600 hover:to-cyan-600 text-white px-8 py-4 sm:px-10 sm:py-5 rounded-full font-semibold shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2 opacity-0 translate-y-10 hero-animate delay-600 flex items-center gap-3 font-vazir text-lg"
      id="heroButton"
    >
      {% trans "سفارش دهید" %}
      <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3"></path>
      </svg>
    </a>
  </div>
</section>

<!-- ===== About Section ===== -->
<section id="about" class="container mx-auto my-16 px-4 sm:px-6 lg:px-8 xl:px-12 bg-gradient-to-b from-white to-blue-50 dark:from-gray-800 dark:to-blue-900 py-12 rounded-2xl">
  <div class="flex flex-col lg:flex-row items-center gap-10 lg:gap-12">
    <div class="lg:w-1/2 flex flex-col items-center lg:items-start opacity-0 translate-y-6 transition-all duration-1000 ease-in-out animate-fadeIn">
      <h2 class="text-3xl sm:text-4xl lg:text-5xl font-extrabold text-blue-700 dark:text-blue-300 tracking-tight mb-6 font-vazir">
        {% trans "چرا ما را انتخاب کنید؟" %}
      </h2>
      <p class="text-gray-600 dark:text-gray-300 text-base sm:text-lg leading-relaxed mb-8 max-w-lg text-center lg:text-right font-vazir">
        {% trans "با بیش از <span class=\"font-bold text-blue-500 dark:text-blue-300\">۲۰ سال تجربه</span>، ما پیشرو در تولید لوله‌های پلی‌اتیلن هستیم. استفاده از مواد اولیه باکیفیت و فناوری مدرن، محصولاتی با <span class=\"font-bold text-cyan-500 dark:text-cyan-300\">استاندارد جهانی</span> ارائه می‌دهد." %}
      </p>
      <ul class="text-gray-600 dark:text-gray-300 text-base sm:text-lg space-y-4 mb-8 max-w-lg text-center lg:text-right font-vazir">
        <li class="flex items-center justify-center lg:justify-end gap-3">
          <svg class="w-6 h-6 text-cyan-500 dark:text-cyan-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
          </svg>
          {% trans "کیفیت تضمین‌شده با مواد اولیه درجه یک" %}
        </li>
        <li class="flex items-center justify-center lg:justify-end gap-3">
          <svg class="w-6 h-6 text-cyan-500 dark:text-cyan-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
          </svg>
          {% trans "دارای گواهینامه‌های بین‌المللی" %}
        </li>
        <li class="flex items-center justify-center lg:justify-end gap-3">
          <svg class="w-6 h-6 text-cyan-500 dark:text-cyan-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
          </svg>
          {% trans "تخصص ۲۰ ساله در صنعت پلی‌اتیلن" %}
        </li>
        <li class="flex items-center justify-center lg:justify-end gap-3">
          <svg class="w-6 h-6 text-cyan-500 dark:text-cyan-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
          </svg>
          {% trans "پشتیبانی ۲۴ ساعته و خدمات پس از فروش" %}
        </li>
      </ul>
      <div class="grid grid-cols-2 sm:grid-cols-4 gap-4 sm:gap-6 text-center mb-8">
        <div class="bg-white dark:bg-gray-800 p-4 rounded-xl shadow-md hover:shadow-lg transition-all duration-300 transform hover:-translate-y-1">
          <p class="text-2xl font-bold text-blue-500 dark:text-blue-300 counter font-vazir" data-target="20">0</p>
          <p class="text-sm text-gray-600 dark:text-gray-400 mt-2 font-vazir">{% trans "سال تجربه" %}</p>
        </div>
        <div class="bg-white dark:bg-gray-800 p-4 rounded-xl shadow-md hover:shadow-lg transition-all duration-300 transform hover:-translate-y-1">
          <p class="text-2xl font-bold text-blue-500 dark:text-blue-300 counter font-vazir" data-target="1563">0</p>
          <p class="text-sm text-gray-600 dark:text-gray-400 mt-2 font-vazir">{% trans "پروژه موفق" %}</p>
        </div>
        <div class="bg-white dark:bg-gray-800 p-4 rounded-xl shadow-md hover:shadow-lg transition-all duration-300 transform hover:-translate-y-1">
          <p class="text-2xl font-bold text-blue-500 dark:text-blue-300 counter font-vazir" data-target="35">0</p>
          <p class="text-sm text-gray-600 dark:text-gray-400 mt-2 font-vazir">{% trans "شهر تحت پوشش" %}</p>
        </div>
        <div class="bg-white dark:bg-gray-800 p-4 rounded-xl shadow-md hover:shadow-lg transition-all duration-300 transform hover:-translate-y-1">
          <p class="text-2xl font-bold text-blue-500 dark:text-blue-300 counter font-vazir" data-target="98">0</p>
          <p class="text-sm text-gray-600 dark:text-gray-400 mt-2 font-vazir">{% trans "رضایت مشتریان (%)" %}</p>
        </div>
      </div>
      <a
        href="{% url 'home:about' %}"
        class="inline-block bg-gradient-to-r from-blue-500 to-cyan-500 hover:from-blue-600 hover:to-cyan-600 text-white font-semibold py-3 px-8 rounded-full shadow-lg hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1 font-vazir"
      >
        {% trans "مشاوره رایگان" %}
      </a>
    </div>
    <div class="lg:w-1/2 mt-8 lg:mt-0 opacity-0 translate-y-6 transition-all duration-1000 ease-in-out animate-slideUp">
      <div class="relative">
        <img
          class="w-full h-80 sm:h-96 lg:h-[28rem] rounded-2xl shadow-xl object-cover transition-transform duration-500 ease-in-out hover:scale-105"
          src="{% static '/images/LPost.jpg' %}"
          alt="Polyethylene Pipes"
        >
        <div class="absolute inset-0 bg-gradient-to-t from-blue-500/20 to-transparent rounded-2xl"></div>
      </div>
    </div>
  </div>
</section>



<style>
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background-color: #f3f4f6;
  }

  @keyframes scroll-right {
    0% { transform: translateX(-100%); }
    100% { transform: translateX(100%); }
  }

  @keyframes scroll-left {
    0% { transform: translateX(100%); }
    100% { transform: translateX(-100%); }
  }

  .scrolling-track-right {
    display: flex;
    gap: 1rem;
    animation: scroll-right 70s linear infinite;
  }

  .scrolling-track-left {
    display: flex;
    gap: 1rem;
    animation: scroll-left 70s linear infinite;
  }

  .scrolling-wrapper {
    overflow: hidden;
    white-space: nowrap;
    padding: 0.5rem 0;
  }

  .testimonial-card {
    min-width: 280px;
    max-width: 300px;
    border-radius: 16px;
    background: linear-gradient(135deg, #ffffff, #fefefe);
    padding: 1rem 1.5rem;
    box-shadow: 0 8px 20px rgba(0,0,0,0.08);
    flex-shrink: 0;
    word-wrap: break-word;
    border-left: 4px solid #6366f1; /* رنگ مدرن */
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }

  .testimonial-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 12px 24px rgba(0,0,0,0.12);
  }

  .testimonial-name {
    font-weight: 600;
    color: #4b5563; /* خاکستری مدرن */
    margin-top: 0.5rem;
    font-size: 0.9rem;
  }

  .testimonial-text {
    font-size: 0.95rem;
    color: #1f2937; /* متن اصلی */
  }

  @media (max-width: 768px) {
    .testimonial-card {
      min-width: 220px;
      padding: 0.75rem 1rem;
    }
  }
</style>
</head>
<body>

<h2 class="text-2xl font-bold mb-6 text-center text-gray-700">نظرات مشتریان</h2>

<!-- طبقه بالایی: حرکت به راست -->
<div class="scrolling-wrapper mb-4">
  <div class="scrolling-track-right">
    <div class="testimonial-card">
      <div class="testimonial-text">کیفیت لوله‌ها عالی بود.</div>
      <div class="testimonial-name">— علی رضایی</div>
    </div>
    <div class="testimonial-card">
      <div class="testimonial-text">نصب بسیار راحت و بدون دردسر.</div>
      <div class="testimonial-name">— سارا موسوی</div>
    </div>
    <div class="testimonial-card">
      <div class="testimonial-text">دوام و مقاومت فوق‌العاده.</div>
      <div class="testimonial-name">— امیرحسین کریمی</div>
    </div>
    <div class="testimonial-card">
      <div class="testimonial-text">ارسال سریع و بسته‌بندی عالی.</div>
      <div class="testimonial-name">— نرگس احمدی</div>
    </div>
    <div class="testimonial-card">
      <div class="testimonial-text">قیمت مناسب نسبت به کیفیت.</div>
      <div class="testimonial-name">— محمد حیدری</div>
    </div>
  </div>
</div>

<!-- طبقه پایینی: حرکت به چپ -->
<div class="scrolling-wrapper">
  <div class="scrolling-track-left">
    <div class="testimonial-card">
      <div class="testimonial-text">پشتیبانی فوق‌العاده و پاسخگو.</div>
      <div class="testimonial-name">— نگار صفایی</div>
    </div>
    <div class="testimonial-card">
      <div class="testimonial-text">تجربه خرید راحت و مطمئن.</div>
      <div class="testimonial-name">— رضا اکبری</div>
    </div>
    <div class="testimonial-card">
      <div class="testimonial-text">نصب بدون مشکل انجام شد.</div>
      <div class="testimonial-name">— هانا محمدی</div>
    </div>
    <div class="testimonial-card">
      <div class="testimonial-text">لوله‌ها مطابق استاندارد بود.</div>
      <div class="testimonial-name">— کیان رستمی</div>
    </div>
    <div class="testimonial-card">
      <div class="testimonial-text">کیفیت و ظاهر عالی، کاملاً راضی هستم.</div>
      <div class="testimonial-name">— الهام مرادی</div>
    </div>
  </div>
</div>



<!-- ===== Gallery Section ===== -->
<div id="gallery" class="relative w-full container mx-auto my-16 px-4 sm:px-6 lg:px-8">
  <div class="relative h-56 md:h-96 overflow-hidden rounded-lg">
    <div class="absolute inset-0 transition-transform duration-700 ease-in-out translate-x-0" data-carousel-item="active">
      <img src="{% static '/images/ad.png' %}" class="w-full h-full object-cover" alt="Gallery Image 1">
    </div>
    <div class="absolute inset-0 transition-transform duration-700 ease-in-out translate-x-full" data-carousel-item>
      <img src="{% static '/images/poly.png' %}" class="w-full h-full object-cover" alt="Gallery Image 2">
    </div>
  </div>
  <button type="button"
          class="absolute top-1/2 left-4 -translate-y-1/2 z-30 flex items-center justify-center w-12 h-12 rounded-full bg-blue-500/50 hover:bg-blue-500/70 focus:outline-none"
          data-carousel-prev>
    <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 6 10">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 1 1 5l4 4"/>
    </svg>
    <span class="sr-only">{% trans "قبلی" %}</span>
  </button>
  <button type="button"
          class="absolute top-1/2 right-4 -translate-y-1/2 z-30 flex items-center justify-center w-12 h-12 rounded-full bg-blue-500/50 hover:bg-blue-500/70 focus:outline-none"
          data-carousel-next>
    <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 6 10">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 9 4-4-4-4"/>
    </svg>
    <span class="sr-only">{% trans "بعدی" %}</span>
  </button>
</div>

<!-- ===== News Section ===== -->
<section class="container mx-auto my-16 px-4 bg-white dark:bg-gray-800 py-12 rounded-lg">
  <h2 class="text-3xl font-bold mb-8 text-center text-blue-700 dark:text-blue-300 font-vazir">{% trans "اخبار و اطلاعیه‌های صنعت پلی‌اتیلن" %}</h2>
  <div class="flex flex-row overflow-x-auto gap-6 md:grid md:grid-cols-3 md:overflow-visible">
    {% for post in posts %}
    <div class="bg-white dark:bg-gray-800 shadow-md rounded-lg overflow-hidden hover:shadow-xl transition duration-300 min-w-[80%] sm:min-w-[45%] md:min-w-0">
      <img src="{{ post.image.url }}" class="w-full h-48 object-contain bg-gray-100" alt="{{ post.title }}">
      <div class="p-4">
        <h3 class="font-semibold text-lg mb-2 text-blue-600 dark:text-blue-300 font-vazir">{{ post.title }}</h3>
        <p class="text-gray-600 dark:text-gray-300 text-sm font-vazir">{{ post.content|truncatechars:100 }}</p>
      </div>
    </div>
    {% endfor %}
  </div>
</section>

<!-- ===== Chat Modal ===== -->
<div class="fixed bottom-8 right-4 z-50">
  <button id="chatBtn"
          class="bg-blue-500 hover:bg-blue-600 text-white px-5 py-3 rounded-full shadow-lg flex items-center space-x-2 transform hover:scale-105 transition-all duration-300 font-vazir">
    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"></path>
    </svg>
    <span>{% trans "مشاوره آنلاین" %}</span>
  </button>
  <div id="chatModal"
       class="fixed inset-0 bg-black/60 hidden flex items-center justify-center px-4 sm:px-6 overflow-y-auto">
    <div id="chatBox"
         class="bg-white dark:bg-gray-800 rounded-2xl shadow-2xl w-full max-w-[90vw] sm:max-w-lg p-4 sm:p-6 relative transform scale-95 opacity-0 font-vazir">
      <h3 class="text-xl sm:text-2xl font-bold mb-2 text-center text-blue-600 dark:text-blue-300">{% trans "فرم مشاوره و تماس" %}</h3>
      <p class="text-gray-600 dark:text-gray-300 mb-4 sm:mb-6 text-center text-sm">
        {% trans "لطفاً اطلاعات خود را وارد کنید تا کارشناسان ما در اسرع وقت با شما تماس بگیرند." %}
      </p>
      <form id="contactForm" method="post">
        {% csrf_token %}
        <div class="relative mb-4 sm:mb-6">
          <input type="text" id="name" name="name" required
                 class="peer w-full px-4 py-2 sm:py-3 border-b-2 border-gray-300 text-gray-900 placeholder-transparent focus:outline-none focus:border-blue-500 bg-gray-50 dark:bg-gray-700 dark:text-gray-200 rounded-lg">
          <label for="name"
                 class="absolute right-4 top-0 text-gray-500 dark:text-gray-400 text-xs sm:text-sm transition-all peer-placeholder-shown:top-2 sm:peer-placeholder-shown:top-3 peer-placeholder-shown:text-gray-400 peer-placeholder-shown:text-sm sm:peer-placeholder-shown:text-base">
            {% trans "نام و نام خانوادگی" %}
          </label>
        </div>
        <div class="relative mb-4 sm:mb-6">
          <input type="tel" id="phone" name="phone" required
                 class="peer w-full px-4 py-2 sm:py-3 border-b-2 border-gray-300 text-gray-900 placeholder-transparent focus:outline-none focus:border-blue-500 bg-gray-50 dark:bg-gray-700 dark:text-gray-200 rounded-lg">
          <label for="phone"
                 class="absolute right-4 top-0 text-gray-500 dark:text-gray-400 text-xs sm:text-sm transition-all peer-placeholder-shown:top-2 sm:peer-placeholder-shown:top-3 peer-placeholder-shown:text-gray-400 peer-placeholder-shown:text-sm sm:peer-placeholder-shown:text-base">
            {% trans "شماره تماس" %}
          </label>
        </div>
        <div class="relative mb-4 sm:mb-6">
          <input type="email" id="email" name="email"
                 class="peer w-full px-4 py-2 sm:py-3 border-b-2 border-gray-300 text-gray-900 placeholder-transparent focus:outline-none focus:border-blue-500 bg-gray-50 dark:bg-gray-700 dark:text-gray-200 rounded-lg">
          <label for="email"
                 class="absolute right-4 top-0 text-gray-500 dark:text-gray-400 text-xs sm:text-sm transition-all peer-placeholder-shown:top-2 sm:peer-placeholder-shown:top-3 peer-placeholder-shown:text-gray-400 peer-placeholder-shown:text-sm sm:peer-placeholder-shown:text-base">
            {% trans "ایمیل (اختیاری)" %}
          </label>
        </div>
        <div class="relative mb-4 sm:mb-6">
          <select id="subject" name="subject"
                  class="w-full px-4 py-2 sm:py-3 border-b-2 border-gray-300 text-gray-900 focus:outline-none focus:border-blue-500 bg-gray-50 dark:bg-gray-700 dark:text-gray-200 rounded-lg">
            <option>{% trans "سفارش محصول" %}</option>
            <option>{% trans "مشاوره فنی" %}</option>
            <option>{% trans "پشتیبانی" %}</option>
            <option>{% trans "سایر" %}</option>
          </select>
          <label for="subject" class="absolute right-4 top-0 text-gray-500 dark:text-gray-400 text-xs sm:text-sm">
            {% trans "موضوع" %}
          </label>
        </div>
        <div class="relative mb-4 sm:mb-6">
          <textarea id="message" name="message" rows="3"
                    class="peer w-full px-4 py-2 sm:py-3 border-b-2 border-gray-300 text-gray-900 placeholder-transparent focus:outline-none focus:border-blue-500 bg-gray-50 dark:bg-gray-700 dark:text-gray-200 rounded-lg"></textarea>
          <label for="message"
                 class="absolute right-4 top-0 text-gray-500 dark:text-gray-400 text-xs sm:text-sm transition-all peer-placeholder-shown:top-2 sm:peer-placeholder-shown:top-3 peer-placeholder-shown:text-gray-400 peer-placeholder-shown:text-sm sm:peer-placeholder-shown:text-base">
            {% trans "توضیحات (اختیاری)" %}
          </label>
        </div>
        <button type="submit"
                class="w-full bg-blue-500 hover:bg-blue-600 text-white py-2 sm:py-3 rounded-lg font-semibold transition-all duration-300 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-500 font-vazir">
          {% trans "ارسال درخواست" %}
        </button>
      </form>
      <div id="successMsg" class="hidden mt-4 sm:mt-6 text-center">
        <div class="bg-green-100 border border-green-300 text-green-700 px-4 py-2 sm:py-3 rounded-lg font-vazir">
          {% trans "✅ درخواست شما با موفقیت ارسال شد. کارشناسان ما به زودی تماس خواهند گرفت." %}
        </div>
      </div>
      <button id="closeModal"
              class="absolute top-2 right-2 text-gray-500 hover:text-gray-800 dark:hover:text-gray-200 text-xl sm:text-2xl focus:outline-none">&times;</button>
    </div>
  </div>
</div>

<!-- ===== Styles for Chat Modal ===== -->
<style>
  #chatModal.show #chatBox {
    transform: scale(1);
    opacity: 1;
  }
  @media (max-width: 640px) {
    #chatModal {
      align-items: flex-end; /* مودال از پایین صفحه باز می‌شود */
      padding-bottom: 1rem;
    }
    #chatBox {
      max-width: 90vw; /* عرض مودال 90% عرض صفحه */
      margin-bottom: 1rem;
      border-radius: 1rem 1rem 0 0; /* گوشه‌های بالایی گرد، پایینی صاف */
    }
    #chatBtn {
      padding: 0.5rem 1rem;
      font-size: 0.9rem;
    }
  }
  @media (min-width: 641px) {
    #chatBox {
      max-width: 32rem;
      padding: 1.5rem;
    }
  }
</style>
<!-- فونت Vazirmatn -->

{% endblock %}

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', () => {
  // ===== انیمیشن هیرو =====
  const heroElements = document.querySelectorAll('.hero-animate');
  heroElements.forEach((el, index) => {
    setTimeout(() => {
      el.classList.add('opacity-100', 'translate-y-0');
    }, 100 * index);
  });

  // ===== کانتر =====
  const counters = document.querySelectorAll('.counter');
  counters.forEach(counter => {
    const updateCounter = () => {
      const target = +counter.getAttribute('data-target');
      const count = +counter.innerText;
      const increment = target / 200;
      if (count < target) {
        counter.innerText = Math.ceil(count + increment);
        setTimeout(updateCounter, 30);
      } else {
        counter.innerText = target;
      }
    };
    updateCounter();
  });

  // ===== انیمیشن ورود محتوا و تصویر =====
  const elements = document.querySelectorAll('.animate-fadeIn, .animate-slideUp');
  elements.forEach((el, index) => {
    setTimeout(() => {
      el.classList.add('opacity-100', 'translate-y-0');
    }, 100 * index);
  });

  // ===== گالری carousel =====
  const items = document.querySelectorAll('[data-carousel-item]');
  let current = 0;
  const updateSlides = (next) => {
    items.forEach(item => {
      item.classList.add('translate-x-full');
      item.classList.remove('translate-x-0');
    });
    items[next].classList.remove('translate-x-full');
    items[next].classList.add('translate-x-0');
    current = next;
  };
  document.querySelector('[data-carousel-next]').addEventListener('click', () => {
    let next = (current + 1) % items.length;
    updateSlides(next);
  });
  document.querySelector('[data-carousel-prev]').addEventListener('click', () => {
    let next = (current - 1 + items.length) % items.length;
    updateSlides(next);
  });

  // ===== چت مودال =====
  const chatBtn = document.getElementById('chatBtn');
  const chatModal = document.getElementById('chatModal');
  const chatBox = document.getElementById('chatBox');
  const closeModal = document.getElementById('closeModal');
  const contactForm = document.getElementById('contactForm');
  const successMsg = document.getElementById('successMsg');

  chatBtn.addEventListener('click', () => {
    chatModal.classList.remove('hidden');
    setTimeout(() => {
      chatModal.classList.add('show');
      chatBox.classList.remove('scale-95', 'opacity-0');
      chatBox.classList.add('scale-100', 'opacity-100');
    }, 10);
  });

  closeModal.addEventListener('click', () => {
    chatModal.classList.remove('show');
    chatBox.classList.remove('scale-100', 'opacity-100');
    chatBox.classList.add('scale-95', 'opacity-0');
    setTimeout(() => {
      chatModal.classList.add('hidden');
    }, 400);
  });

  chatModal.addEventListener('click', (e) => {
    if (e.target === chatModal) {
      chatModal.classList.remove('show');
      chatBox.classList.remove('scale-100', 'opacity-100');
      chatBox.classList.add('scale-95', 'opacity-0');
      setTimeout(() => {
        chatModal.classList.add('hidden');
      }, 400);
    }
  });

  contactForm.addEventListener('submit', (e) => {
    e.preventDefault();
    const formData = new FormData(contactForm);
    fetch('/submit-consultation/', {
      method: 'POST',
      headers: {
        'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]').value
      },
      body: formData
    })
    .then(response => response.json())
    .then(data => {
      if (data.success) {
        contactForm.classList.add('hidden');
        successMsg.classList.remove('hidden');
      }
    });
  });

  // ===== افکت پارالاکس =====
  const heroSection = document.querySelector('section.relative');
  window.addEventListener('scroll', () => {
    const offset = window.scrollY * 0.2;
    heroSection.querySelector('img').style.transform = `translateY(${offset}px) scale(1.05)`;
  });
});
</script>

{% endblock %}